/* Custom styles for duckdb-behavioral documentation */

/* Typography refinements */
:root {
    --content-max-width: 860px;
}

.content main {
    max-width: var(--content-max-width);
}

/* Code block styling */
pre {
    border-radius: 4px;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
}

code {
    font-size: 0.9em;
}

/* ── Table styling ────────────────────────────────────────────────────
 * Tables use a horizontal scroll wrapper on narrow viewports to prevent
 * layout overflow. Performance tables with many columns remain readable
 * without truncating content or breaking the page layout.
 */
table {
    width: 100%;
    border-collapse: collapse;
    margin: 1em 0;
    display: block;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
}

table thead th {
    text-align: left;
    font-weight: 600;
    border-bottom: 2px solid var(--table-border-color);
    padding: 8px 12px;
    white-space: nowrap;
}

table tbody td {
    padding: 8px 12px;
    border-bottom: 1px solid var(--table-border-color);
}

table tbody tr:last-child td {
    border-bottom: none;
}

/* Performance numbers emphasis — prevent wrapping in data cells */
table td code {
    white-space: nowrap;
}

/* Prevent benchmark function names from wrapping mid-name */
table td:first-child,
table th:first-child {
    white-space: nowrap;
}

/* Sidebar refinements */
.sidebar .sidebar-scrollbox {
    padding-top: 16px;
}

/* Navigation section headers */
.chapter li.part-title {
    margin-top: 16px;
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.85em;
    letter-spacing: 0.05em;
}

/* Heading anchors */
.content main h1 {
    margin-top: 0;
    padding-top: 0;
}

.content main h2 {
    margin-top: 2em;
    padding-top: 0.5em;
    border-top: 1px solid var(--table-border-color);
}

.content main h3 {
    margin-top: 1.5em;
}

/* Blockquote styling for notes */
blockquote {
    border-left: 4px solid var(--sidebar-active);
    padding: 0.5em 1em;
    margin: 1em 0;
    background-color: var(--quote-bg);
}

/* ── Mermaid Diagram Contrast Fix ──────────────────────────────────────
 * Forces high-contrast text and borders on all Mermaid diagram elements.
 * Ensures readability in both light (default) and dark (navy/coal) themes.
 *
 * Mermaid renders labels inside <foreignObject> HTML elements within SVG,
 * so we must target both SVG <text> (via fill) and HTML <div>/<span>
 * (via color) to guarantee coverage across all rendering paths.
 *
 * The %%{init: {'theme': 'base', ...}}%% directives in each diagram
 * control mermaid's internal rendering. These CSS rules serve as a
 * defense-in-depth layer ensuring readability regardless of theme.
 */

/* ── SVG text elements ─────────────────────────────────────────────── */
.mermaid text {
    fill: #000000 !important;
}

/* ── HTML labels inside foreignObject (mermaid's primary label path) ─ */
.mermaid foreignObject div,
.mermaid foreignObject span,
.mermaid foreignObject p,
.mermaid .nodeLabel,
.mermaid .edgeLabel,
.mermaid .label,
.mermaid .cluster-label,
.mermaid .edgeLabel span,
.mermaid .edgeLabel p {
    color: #000000 !important;
    fill: #000000 !important;
}

/* ── Node shapes: visible borders ──────────────────────────────────── */
.mermaid .node rect,
.mermaid .node circle,
.mermaid .node polygon,
.mermaid .node path,
.mermaid .node .label-container {
    stroke: #495057 !important;
    stroke-width: 2px !important;
}

/* ── Subgraph/cluster labels and borders ───────────────────────────── */
.mermaid .cluster rect {
    stroke: #495057 !important;
    stroke-width: 2px !important;
    rx: 4px !important;
    ry: 4px !important;
}

.mermaid .cluster text,
.mermaid .cluster span,
.mermaid .cluster foreignObject div {
    fill: #000000 !important;
    color: #000000 !important;
    font-weight: 600 !important;
}

/* ── Edge/arrow lines ──────────────────────────────────────────────── */
.mermaid .edgePath path,
.mermaid .flowchart-link {
    stroke: #495057 !important;
    stroke-width: 2px !important;
}

/* ── Arrow markers ─────────────────────────────────────────────────── */
.mermaid marker path {
    fill: #495057 !important;
}

/* ── Edge labels: white background for readability ─────────────────── */
.mermaid .edgeLabel rect,
.mermaid .edgeLabel .label-container {
    fill: #ffffff !important;
    opacity: 0.95 !important;
}

/* ── State diagram specifics ───────────────────────────────────────── */
.mermaid .statediagram-state rect,
.mermaid .stateGroup rect {
    stroke: #495057 !important;
    stroke-width: 2px !important;
}

.mermaid .statediagram-state .state-title,
.mermaid .stateGroup text {
    fill: #000000 !important;
    font-weight: 600 !important;
}

/* State diagram transition labels */
.mermaid .transition text,
.mermaid .stateLabel text {
    fill: #000000 !important;
}

/* ── Decision diamond (rhombus) text ───────────────────────────────── */
.mermaid .node .label {
    color: #000000 !important;
}

/* ── Note boxes in state diagrams ──────────────────────────────────── */
.mermaid .note {
    fill: #fff9c4 !important;
    stroke: #c8a415 !important;
}

.mermaid .note text,
.mermaid .note foreignObject div {
    fill: #000000 !important;
    color: #000000 !important;
}

/* ── Dark theme (navy/coal) overrides ──────────────────────────────── */

/* SVG text */
.navy .mermaid text,
.coal .mermaid text {
    fill: #000000 !important;
}

/* HTML labels inside foreignObject */
.navy .mermaid foreignObject div,
.navy .mermaid foreignObject span,
.navy .mermaid .nodeLabel,
.navy .mermaid .edgeLabel,
.navy .mermaid .label,
.navy .mermaid .cluster-label,
.coal .mermaid foreignObject div,
.coal .mermaid foreignObject span,
.coal .mermaid .nodeLabel,
.coal .mermaid .edgeLabel,
.coal .mermaid .label,
.coal .mermaid .cluster-label {
    color: #000000 !important;
    fill: #000000 !important;
}

/* Edges and arrows: slightly lighter for dark backgrounds */
.navy .mermaid .edgePath path,
.navy .mermaid .flowchart-link,
.coal .mermaid .edgePath path,
.coal .mermaid .flowchart-link {
    stroke: #6c757d !important;
}

.navy .mermaid marker path,
.coal .mermaid marker path {
    fill: #6c757d !important;
}

/* Edge label backgrounds: light gray for dark themes */
.navy .mermaid .edgeLabel rect,
.navy .mermaid .edgeLabel .label-container,
.coal .mermaid .edgeLabel rect,
.coal .mermaid .edgeLabel .label-container {
    fill: #e9ecef !important;
    opacity: 0.95 !important;
}

/* Cluster/subgraph borders: lighter for dark themes */
.navy .mermaid .cluster rect,
.coal .mermaid .cluster rect {
    stroke: #6c757d !important;
}

/* ── Mobile responsiveness ───────────────────────────────────────────
 * Ensures the documentation renders correctly on phones and tablets.
 * Tables scroll horizontally, code blocks don't overflow, and content
 * has appropriate padding at narrow viewport widths.
 */

/* Prevent content overflow on narrow screens */
.content main {
    overflow-x: hidden;
    word-wrap: break-word;
    overflow-wrap: break-word;
}

/* Mermaid diagrams: scroll horizontally on narrow viewports */
.mermaid {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    max-width: 100%;
}

/* Mermaid SVG should not exceed container width */
.mermaid svg {
    max-width: 100%;
    height: auto;
}

@media screen and (max-width: 768px) {
    /* Reduce padding on mobile */
    .content main {
        padding: 0 12px;
    }

    /* Tighter table cells */
    table thead th,
    table tbody td {
        padding: 6px 8px;
        font-size: 0.88em;
    }

    /* Allow long inline code to break */
    code {
        word-break: break-all;
    }

    /* Reduce heading margins */
    .content main h2 {
        margin-top: 1.5em;
        padding-top: 0.3em;
    }

    .content main h3 {
        margin-top: 1em;
    }

    /* Blockquotes tighter on mobile */
    blockquote {
        padding: 0.3em 0.8em;
        margin: 0.8em 0;
    }

    /* Prevent horizontal overflow from wide content */
    pre {
        max-width: calc(100vw - 40px);
    }
}

@media screen and (max-width: 480px) {
    /* Extra-small screens */
    table thead th,
    table tbody td {
        padding: 4px 6px;
        font-size: 0.82em;
    }

    .content main {
        padding: 0 8px;
    }

    code {
        font-size: 0.85em;
    }
}
